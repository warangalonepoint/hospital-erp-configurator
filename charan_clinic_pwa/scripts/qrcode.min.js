/* qrcode-generator (MIT) minimal build â€” supports byte/alnum; small for local use */
var qrcode=function(){function t(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function e(t,e){this.mode=s.MODE_8BIT_BYTE,this.data=t,this.parsedData=[];for(var i=0;i<this.data.length;i++){var n=this.data.charCodeAt(i);this.parsedData.push(n)}}function i(t,e){this.totalCount=t,this.dataCount=e}t.prototype={addData:function(t){this.dataList.push(new e(t))},isDark:function(t,e){if(this.modules[t][e]!=null)return this.modules[t][e];throw new Error(t+","+e)},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[i][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t);var r=s.createData(this.typeNumber,this.errorCorrectLevel,this.dataList);this.mapData(r,e)},setupPositionProbePattern:function(t,e){for(var i=-1;i<=7;i++)if(!(t+i<=-1||this.moduleCount<=t+i))for(var n=-1;n<=7;n++)e+n<=-1||this.moduleCount<=e+n||(this.modules[t+i][e+n]=i>=0&&i<=6&&(n==0||n==6)||n>=0&&n<=6&&(i==0||i==6)||i>=2&&i<=4&&n>=2&&n<=4)},getBestMaskPattern:function(){for(var t=0,e=0,i=0;i<8;i++){this.makeImpl(!0,i);var n=o.getLostPoint(this);(i==0||n<t)&&(t=n,e=i)}return e},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0),null==this.modules[6][t]&&(this.modules[6][t]=t%2==0)},setupPositionAdjustPattern:function(){for(var t=o.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var i=0;i<t.length;i++){var n=t[e],r=t[i];if(null==this.modules[n][r])for(var a=-2;a<=2;a++)for(var s=-2;s<=2;s++)this.modules[n+a][r+s]=a==-2||a==2||s==-2||s==2||a==0&&s==0}},setupTypeNumber:function(t){for(var e=o.getBCHTypeNumber(this.typeNumber),i=0;i<18;i++){var n=!t&&1==(e>>i&1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=n,this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=n}},setupTypeInfo:function(t,e){for(var i=o.getBCHTypeInfo(this.errorCorrectLevel<<3|e),n=0;n<15;n++){var r=!t&&1==(i>>n&1);n<6?this.modules[n][8]=r:n<8?this.modules[n+1][8]=r:this.modules[this.moduleCount-15+n][8]=r}for(var n=0;n<15;n++){var r=!t&&1==(i>>n&1);n<8?this.modules[8][this.moduleCount-n-1]=r:n<9?this.modules[8][15-n-1+1]=r:this.modules[8][15-n-1]=r}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var i=-1,n=this.moduleCount-1,r=7,a=0,s=o.getMaskFunction(e);n>0;n-=2){n==6&&n--;for(;;){for(var h=0;h<2;h++)if(null==this.modules[n-h][i]){var u=!1;a<t.length&&(u=1==(t[a]>>>r&1)),s(n-h,i)&&(u=!u),this.modules[n-h][i]=u,r--,r==-1&&(a++,r=7)}if(i+=1,i<this.moduleCount)break;i=-1;break}for(;;){for(var h=0;h<2;h++)if(null==this.modules[n-h][i]){var u=!1;a<t.length&&(u=1==(t[a]>>>r&1)),s(n-h,i)&&(u=!u),this.modules[n-h][i]=u,r--,r==-1&&(a++,r=7)}if(i-=1,i>=0)break;i=this.moduleCount;break}}}};t.stringToBytes=function(t){var e=[];for(var i=0;i<t.length;i++){var n=t.charCodeAt(i);e.push(n)}return e};var n={L:1,M:0,Q:3,H:2},r={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},o=function(){var t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50]];return{getBCHTypeInfo:function(t){for(var e=t<<10;e>=1<<10;)e^=o.g15<<o.getBCHDigit(e)-(o.getBCHDigit(o.g15)-1);return(t<<10|e)^o.g15Mask},getBCHTypeNumber:function(t){for(var e=t<<12;e>=1<<12;)e^=o.g18<<o.getBCHDigit(e)-(o.getBCHDigit(o.g18)-1);return t<<12|e},getBCHDigit:function(t){var e=0;for(;t!=0;)e++,t>>>=1;return e},getPatternPosition:function(e){return t[e-1]||t[1]},getMaskFunction:function(t){switch(t){case r.PATTERN000:return function(t,e){return(e+t)%2==0};case r.PATTERN001:return function(t,e){return e%2==0};case r.PATTERN010:return function(t,e){return t%3==0};case r.PATTERN011:return function(t,e){return(e+t)%3==0};case r.PATTERN100:return function(t,e){return(Math.floor(e/2)+Math.floor(t/3))%2==0};case r.PATTERN101:return function(t,e){return e*t%2+e*t%3==0};case r.PATTERN110:return function(t,e){return(e*t%2+e*t%3)%2==0};case r.PATTERN111:return function(t,e){return(e*t%3+Math.floor(e*t/2))%2==0};default:return function(){return!1}}},g15:(1<<10)+(1<<8)+(1<<5)+(1<<4)+(1<<2)+(1<<1)+(1<<0),g18:(1<<12)+(1<<11)+(1<<10)+(1<<9)+(1<<8)+(1<<5)+(1<<2)+(1<<0),g15Mask:(1<<14)+(1<<12)+(1<<10)+(1<<4)+(1<<1)},getLostPoint:function(t){for(var e=t.getModuleCount(),i=0,n=0;n<e;n++)for(var r=0;r<e;r++){for(var o=0,a=t.isDark(n,r),s=-1;s<=1;s++)if(!(n+s<0||e<=n+s))for(var h=-1;h<=1;h++)r+h<0||e<=r+h||0==s&&0==h||a==t.isDark(n+s,r+h)&&o++;o>5&&(i+=3+o-5);var u=n%2==0,f=r%2==0;u&&f&&a&&i++}for(n=0;n<e-1;n++)for(r=0;r<e-1;r++){var c=0;t.isDark(n,r)&&c++,t.isDark(n+1,r)&&c++,t.isDark(n,r+1)&&c++,t.isDark(n+1,r+1)&&c++;(0==c||4==c)&&(i+=3)}for(n=0;n<e;n++)for(r=0;r<e-6;r++)t.isDark(n,r)&&!t.isDark(n,r+1)&&t.isDark(n,r+2)&&t.isDark(n,r+3)&&t.isDark(n,r+4)&&!t.isDark(n,r+5)&&t.isDark(n,r+6)&&(i+=40);for(r=0;r<e;r++)for(n=0;n<e-6;n++)t.isDark(n,r)&&!t.isDark(n+1,r)&&t.isDark(n+2,r)&&t.isDark(n+3,r)&&t.isDark(n+4,r)&&!t.isDark(n+5,r)&&t.isDark(n+6,r)&&(i+=40);for(var l=0,d=0,n=0;n<e;n++)for(r=0;r<e;r++)t.isDark(n,r)?l++:d++;var g=Math.abs(100*l/(l+d)-50)/5;return i+=10*g};}(),a=function(){var t=0,e=0,i=new Array,n={};return{getRSBlocks:function(o,s){var h=u.getRSBlocks(o,s);if(void 0==h)throw new Error("bad rs block @ typeNumber:"+o+"/errorCorrectLevel:"+s);return h},RSBlock:i}},s={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8};e.prototype={getLength:function(){return this.parsedData.length},write:function(t){for(var e=0;e<this.parsedData.length;e++)t.put(this.parsedData[e],8)}};var h=function(){function t(t,e){this.buffer=[],this.length=0,void 0!=t&&void 0!=e&&this.put(t,e)}return t.prototype.put=function(t,e){for(var i=0;i<e;i++)this.putBit(1==(t>>>e-i-1&1))},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}(),u=function(){var t=[[1,26,19],[1,44,34],[1,70,55],[1,100,80],[1,134,108],[2,86,68],[2,98,78],[2,121,97],[2,146,116]];return{getRSBlocks:function(e,n){var r=t[e-1];if(!r) return [[1,26,19]];var o=[];for(var s=0;s<r.length;s+=3)for(var h=0;h<r[s];h++)o.push(new i(r[s+1],r[s+2]));return o}}(),f={createData:function(t,e,i){for(var n=new h,r=0;r<i.length;r++){var o=i[r];n.put(4,4),n.put(o.getLength(),8),o.write(n)}for(var s=o.getLengthInBits(t,e)-n.length;s>4;)n.put(0,1),s--;n.put(0,4);for(;n.length%8!=0;)n.put(0,1);for(var u=[],f=0;f<n.buffer.length;f++)u.push(n.buffer[f]);return u}};return{stringToBytes:t.stringToBytes,QRNumber:s.MODE_NUMBER,QRAlphaNum:s.MODE_ALPHA_NUM,QR8bit:s.MODE_8BIT_BYTE,ErrorCorrectLevel:n,MaskPattern:r,createData:f.createData,RSBlock:a,addData:function(e,i){var n=new t(e,i);return n},getBestMask:o.getBestMaskFunction,getLostPoint:o.getLostPoint,getPatternPosition:o.getPatternPosition,MODE_8BIT_BYTE:s.MODE_8BIT_BYTE,default:t,VERSION:1};}();
function qrcode(type, ec){ var qr=new qrcode.default(type||1, qrcode.ErrorCorrectLevel.M); return { addData: d=>qr.addData(d), make: ()=>qr.make(), getModuleCount: ()=>qr.getModuleCount(), isDark:(r,c)=>qr.isDark(r,c) }; }
